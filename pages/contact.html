<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>devSignature</title>
    <link rel="stylesheet" href="../style.css">
    <style>
        #content {
            display: flex;
            row-gap: 0.20rem;
            flex-direction: column;
            align-items: center;
            height: 95%;
        }

        #content>* {
            margin: 0;
        }

        .contact-label {
            font-weight: bold;
            color: var(--text-primary);
        }

        .contact-value {
            font-weight: normal;
            color: var(--text-primary);
        }

        /* ====== FORMULARIO (AGREGADO) ====== */

        .field-group {
            display: flex;
            flex-direction: column;
            width: 100%;
        }

        .error-message {
            color: #ff3b3b;
            font-size: 0.9rem;
            margin-bottom: 0.3rem;
            min-height: 18px;
        }


        #contact-form-container {
            width: 400px;
            background: linear-gradient(#282828, #393A29);
            padding: 2rem 3rem;
            border-radius: 20px;
            box-shadow: 0 0 20px 5px black;
            /* box-shadow: 0 0 40px rgba(255, 215, 0, 0.3); */
            margin: 3rem 0;
        }

        #contact-form {
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }

        #contact-form input,
        #contact-form select,
        #contact-form textarea {
            background: black;
            border: none;
            padding: 0.8rem;
            color: white;
            border-radius: 6px;
            outline: none;
            font-size: 1rem;
        }

        #contact-form textarea {
            resize: none;
            height: 120px;
        }

        #contact-form button {
            background: gold;
            border: none;
            padding: 0.8rem;
            border-radius: 25px;
            font-weight: bold;
            cursor: pointer;
            transition: 0.3s ease;
        }

        #contact-form button.hover {
            background: #ffd700;
            box-shadow: 0 0 20px gold;
        }

        #char-counter {
            font-size: 0.8rem;
            text-align: right;
            color: #ccc;
        }

        #form-message {
            font-size: 0.9rem;
            text-align: center;
            margin-top: 0.5rem;
        }

        /* ====== FIN FORMULARIO ====== */
    </style>
</head>

<body>
    <script src="../script.js"></script>
    <div id="navbar">
        <div class="navbar-brand">
            <a href="/" style="display:flex; align-items:center;">
                <img src="../logo.png" height="85">
            </a>

            <a href="/" style="text-decoration:none;">
                <h1 style="font-weight:normal;color:white;">
                    devSignature
                </h1>
            </a>
        </div>

        <!-- 游댌 BUSCADOR INTERNO -->
        <div class="navbar-search">
            <span class="search-icon" onclick="goToAdvancedSearch()">游댌</span>
            <input type="text" id="site-search" placeholder="Buscar en el sitio..." oninput="searchSite()" />
            <div id="search-results"></div>
        </div>

        <a class="navbar-button" href="/pages/about_us.html">
            Sobre Nosotros
        </a>

        <a class="navbar-button" href="/pages/services.html">
            Servicios
        </a>

        <div class="navbar-dropdown">
            <button class="navbar-button">Mas</button>

            <div class="navbar-dropdown-menu">
                <a class="navbar-button" href="/pages/login.html">
                    <span class="dropdown-text">Iniciar Sesion</span>
                </a>

                <a class="navbar-button" href="/pages/contact.html">
                    <span class="dropdown-text">Contacto</span>
                </a>
            </div>
        </div>
    </div>
    <div id="main">
        <div id="main-wrapper">
            <div id="breadcrumb">
                <p style="margin: 0;color:white">游 Inicio > <span
                        style="font-weight: bold;view-transition-name: contact-title;">Contacto</span></p>
            </div>
            <div id="content">
                <h1 style="font-size: 3rem;color: white;font-weight: normal;">Contacto</h1>
                <p style="font-size: 1.5rem;color:#EDEDED;text-align: center;">Si tienes dudas, deseas cotizar un
                    proyecto o necesitas asesor칤a tecnol칩gica, nuestro equipo est치 listo para apoyarte.</p>
                <hr size="1" width="90%" color="#FFFFFF">
                <h2 style="font-size: 2rem;color: white;font-weight: normal;">Informaci칩n de Contacto</h2>
                <ul style="width: 90%;">
                    <li class="contact-label">Correo electr칩nico: <span class="contact-value">contacto@devsig.com</span>
                    </li>
                    <br>
                    <li class="contact-label">Tel칠fono: <span class="contact-value">+52 55 1234 5678</span></li>
                    <br>
                    <li class="contact-label">Horario de atenci칩n: <span class="contact-value">Lunes a Viernes | 9:00
                            a.m. - 6:00 p.m. (hora local)</span></li>
                </ul>
                <h2 style="font-size: 2rem;color: white;font-weight: normal;">쮼n qu칠 podemos ayudarte?</h2>
                <p style="font-size: 1.5rem;color:#EDEDED;text-align: justify; width: 90%;">Puedes contactarnos para:
                </p>
                <ul style="width: 90%; color: #EDEDED;">
                    <li>Desarrollo y redise침o de sitios web</li>
                    <br>
                    <li>Implementaci칩n de comercio electr칩nico</li>
                    <br>
                    <li>Consultoria tecnol칩gica y an치lisis de procesos</li>
                    <br>
                    <li>Soporte y mantenimiento de soluciones digitales</li>
                </ul>

                <!-- ===== FORMULARIO AGREGADO ===== -->
                <div id="contact-form-container">
                    <h2 style="font-size: 2rem;color: white;font-weight: normal;text-align: center;">
                        Env칤anos un correo
                    </h2>

                    <form id="contact-form" novalidate>

                        <div class="field-group">
                            <div class="error-message" id="email-error"></div>
                            <input type="email" id="email" placeholder="correo@gmail.com">
                        </div>

                        <div class="field-group">
                            <div class="error-message" id="tipo-error"></div>
                            <select id="tipo">
                                <option value="">Tipo</option>
                                <option value="Desarrollo Web">Desarrollo Web</option>
                                <option value="Consultor칤a">Consultor칤a</option>
                                <option value="Otros">Otros</option>
                            </select>
                        </div>

                        <div class="field-group">
                            <div class="error-message" id="descripcion-error"></div>
                            <textarea id="descripcion"
                                placeholder="H치blanos brevemente sobre lo que necesitas. (M치ximo 350 caracteres)"
                                maxlength="3500"></textarea>
                            <div id="char-counter">0 / 350</div>
                        </div>

                        <!-- Verificador humano -->
                        <div class="field-group">


                            <label for="pregunta" style="text-align: center;">
                                Pregunta de seguridad:
                                쮺u치nto es 7 + 5?
                            </label>
                            <br>
                            <div class="error-message" id="pregunta-error"></div>
                            <input type="number" id="pregunta" name="pregunta" style="
                                       background: black;
                                        border: none;
                                        padding: 0.8rem;
                                        color: white;
                                        border-radius: 6px;
                                        outline: none;
                                        font-size: 1rem;
                                       " placeholder="Tu respuesta" required>

                        </div>
                        <br>

                        <button type="submit" id="form-btn-submit">Enviar</button>

                    </form>

                </div>
                <!-- ===== FIN FORMULARIO ===== -->

            </div>
        </div>
    </div>
    <div id="modal-container">
        <div class="modal-overlay" id="confirm-modal" aria-hidden="true" style="display:none;">
            <div class="modal" role="dialog" aria-modal="true" aria-labelledby="confirm-title">
                <button class="modal-close" id="confirm-close" aria-label="Cerrar">칑</button>
                <h3 id="confirm-title">쮼st치 seguro que desea enviar el formulario?</h3>
                <p>Por favor confirme que desea enviar la informaci칩n proporcionada.</p>
                <div class="modal-actions">
                    <button class="btn btn-cancel" id="confirm-cancel">Cancelar</button>
                    <button class="btn btn-continue" id="confirm-continue">Continuar</button>
                </div>
            </div>
        </div>

        <div class="modal-overlay" id="success-modal" aria-hidden="true" style="display:none;">
            <div class="modal" role="dialog" aria-modal="true" aria-labelledby="success-title">
                <button class="modal-close" id="success-close" aria-label="Cerrar">칑</button>
                <h3 id="success-title">Formulario Enviado!</h3>
                <p>Gracias. Nos pondremos en contacto pronto.</p>
                <div class="modal-actions">
                    <button class="btn btn-ok" id="success-ok">Ok</button>
                </div>
            </div>
        </div>
    </div>
    <script>
        // === 칈NDICE DEL SITIO ===
        const siteIndex = [
            {
                title: "Inicio",
                description: "P치gina principal con una visi칩n general de devSignature.",
                keywords: "inicio home principal",
                url: "http://127.0.0.1:5500"
            },
            {
                title: "Sobre Nosotros",
                description: "Nuestra misi칩n, visi칩n y el equipo detr치s de devSignature.",
                keywords: "about us nosotros empresa misi칩n visi칩n equipo",
                url: "http://127.0.0.1:5500/pages/about_us.html"
            },
            {
                title: "Servicios",
                description: "Desarrollo web y consultor칤a tecnol칩gica profesional.",
                keywords: "servicios desarrollo web soporte consultor칤a precios",
                url: "http://127.0.0.1:5500/pages/services.html"
            },
            {
                title: "Contacto",
                description: "Formas de comunicarte con nosotros y solicitar soporte.",
                keywords: "contacto email soporte ayuda",
                url: "http://127.0.0.1:5500/pages/contact.html"
            }
        ];

        function searchSite() {
            const input = document.getElementById("site-search");
            const resultsBox = document.getElementById("search-results");
            const query = input.value.toLowerCase();

            resultsBox.innerHTML = "";
            resultsBox.style.display = "none";

            if (!query) return;

            const results = siteIndex.filter(page =>
                page.title.toLowerCase().includes(query) ||
                page.keywords.includes(query)
            );

            if (!results.length) return;

            resultsBox.style.display = "block";

            results.forEach(page => {
                const div = document.createElement("div");
                div.className = "search-item";
                div.innerHTML = `
  <strong>${page.title}</strong>
  <div style="font-size:.9rem; opacity:.8;">
    ${page.description}
  </div>
`;

                div.onclick = () => window.location.href = page.url;
                resultsBox.appendChild(div);
            });
        }

        document.addEventListener("click", e => {
            const search = document.querySelector(".navbar-search");
            if (search && !search.contains(e.target)) {
                const box = document.getElementById("search-results");
                if (box) box.style.display = "none";
            }
        });

        /* ===== VALIDACIONES FORMULARIO (AGREGADO) ===== */
        const form = document.getElementById("contact-form");
        const emailInput = document.getElementById("email");
        const tipoInput = document.getElementById("tipo");
        const descripcionInput = document.getElementById("descripcion");

        const emailError = document.getElementById("email-error");
        const tipoError = document.getElementById("tipo-error");
        const descripcionError = document.getElementById("descripcion-error");
        const preguntaInput = document.getElementById('pregunta');
        const preguntaError = document.getElementById('pregunta-error');

        const cta = document.getElementById("form-btn-submit")

        const counter = document.getElementById("char-counter");

        const emailRegex = /^[A-Za-z0-9_\.-]+@([A-Za-z]+([A-Za-z]+(\.[A-Za-z]+)+))+$/;

        function limpiarErrores() {
            // Limpiar errores
            emailError.textContent = "";
            tipoError.textContent = "";
            descripcionError.textContent = "";
        }

        // Limpiar mensaje de error al escribir
        function applyCleanerListener(inputElement,errorElement) {
            inputElement.addEventListener("input", () => {
                errorElement.textContent = ""
            })
        }

        // Implementaci칩n de listeners
        [{input:emailInput,error:emailError}, {input:preguntaInput,error:preguntaError}].map(set=>{
            applyCleanerListener(set.input,set.error)
        })

        // Contador
        descripcionInput.addEventListener("input", () => {
            if (descripcionInput.value.length > 350) {
                counter.style.color = "#ff3b3b";
                descripcionError.textContent = "L칤mite de car치cteres excedido (" + descripcionInput.value.length + " car치cteres)";
            } else {
                counter.style.color = "#ccc";
                descripcionError.textContent = "";
            }
            counter.textContent = `${descripcionInput.value.length} / 350`;
        });

        // Enviar formulario 
        document.addEventListener("keyup",e=>{
            if(e.key=="Enter"){
                form.requestSubmit()
            }
        })

        cta.addEventListener("mouseleave",()=>{
            cta.classList.remove("hover")
        })
        cta.addEventListener("mouseover",()=>{
            cta.classList.add("hover")
        })

        // Validaci칩n
        form.addEventListener("submit", (e) => {
            e.preventDefault();

            let isValid = true;

            // Limpiar errores
            limpiarErrores()

            // Email vac칤o
            if (emailInput.value.trim() === "") {
                emailError.textContent = "Este campo es obligatorio";
                isValid = false;
            }
            else if (!emailRegex.test(emailInput.value.trim())) {
                emailError.textContent = "El correo electr칩nico no est치 en el formato correcto";
                isValid = false;
            }

            // Dropdown
            if (tipoInput.value === "") {
                tipoError.textContent = "Este campo es obligatorio";
                isValid = false;
            }

            // Descripci칩n
            if (descripcionInput.value.trim() === "") {
                descripcionError.textContent = "Este campo es obligatorio";
                isValid = false;
            }
            else if (descripcionInput.value.length > 350) {
                descripcionError.textContent = "L칤mite de car치cteres excedido (" + descripcionInput.value.length + " car치cteres)";
                isValid = false;
            }

            // Verificaci칩n humana
            if (preguntaInput.value.trim() === "") {
                preguntaError.textContent = "Este campo es obligatorio";
                isValid = false;
            } else if (parseInt(preguntaInput.value, 10) !== 12) {
                preguntaError.textContent = "Respuesta incorrecta";
                isValid = false;
            } else {
                preguntaError.textContent = ""
            }

            if (isValid) {
                const confirmModal = document.getElementById('confirm-modal');
                const successModal = document.getElementById('success-modal');
                const confirmCancel = document.getElementById('confirm-cancel');
                const confirmContinue = document.getElementById('confirm-continue');
                const confirmClose = document.getElementById('confirm-close');
                const successOk = document.getElementById('success-ok');
                const successClose = document.getElementById('success-close');

                function openModal(modal) {
                    modal.style.display = 'flex';
                    modal.setAttribute('aria-hidden', 'false');
                    document.body.style.overflow = 'hidden';
                }

                function closeModal(modal) {
                    modal.style.display = 'none';
                    modal.setAttribute('aria-hidden', 'true');
                    document.body.style.overflow = '';
                }

                openModal(confirmModal);

                const onCancel = () => closeModal(confirmModal);
                const onCloseConfirm = () => closeModal(confirmModal);
                const onContinue = () => {
                    closeModal(confirmModal);
                    limpiarErrores();
                    form.reset();
                    counter.textContent = '0 / 350';
                    openModal(successModal);
                    console.log('Usuario verificado');
                };
                const onSuccessClose = () => closeModal(successModal);

                confirmCancel.addEventListener('click', onCancel, { once: true });
                confirmClose.addEventListener('click', onCloseConfirm, { once: true });
                confirmContinue.addEventListener('click', onContinue, { once: true });

                successOk.addEventListener('click', onSuccessClose, { once: true });
                successClose.addEventListener('click', onSuccessClose, { once: true });

                // Close when clicking outside the modal content
                confirmModal.addEventListener('click', (ev) => {
                    if (ev.target === confirmModal) closeModal(confirmModal);
                });
                successModal.addEventListener('click', (ev) => {
                    if (ev.target === successModal) closeModal(successModal); document.getElementById("contact-form-container").innerHTML = "<p style='text-align:center'>Formulario Enviado!</p>";
                });
            }
        });


    </script>
</body>

</html>